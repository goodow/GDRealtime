//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//
//  Created by Larry Tin <dev@goodow.com>
//

#include "com/goodow/realtime/channel/Channel.h"
#include "com/goodow/realtime/channel/http/HttpTransport.h"
#include "com/goodow/realtime/channel/http/objc/ObjCHttpTransport.h"
#include "com/goodow/realtime/channel/objc/ObjCChannel.h"
#include "com/goodow/realtime/channel/util/impl/ObjCChannelFactory.h"
#include "java/lang/Runnable.h"

@implementation ComGoodowRealtimeChannelUtilImplObjCChannelFactory

- (id<ComGoodowRealtimeChannelChannel>)createChannelWithNSString:(NSString *)token {
  return [[ComGoodowRealtimeChannelObjcObjCChannel alloc] init];
}

- (NSString *)escapeUriQueryWithNSString:(NSString *)value {
  return [value stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
}

- (NSString *)getDefaultUserAgent {
  static NSString * userAgent;
  #if TARGET_OS_IPHONE == 1 || TARGET_OS_IPHONE_SIMULATOR == 1
  if (!userAgent) {
    UIWebView *webView = [[UIWebView alloc]initWithFrame:CGRectZero];
    userAgent = [webView stringByEvaluatingJavaScriptFromString:@"navigator.userAgent"];
  }
  #endif
  return userAgent;
}

- (ComGoodowRealtimeChannelHttpHttpTransport *)getHttpTransport {
  return [[ComGoodowRealtimeChannelHttpObjcObjCHttpTransport alloc] init];
}

- (void)scheduleDeferredWithJavaLangRunnable:(id<JavaLangRunnable>)cmd {
  #if TARGET_OS_IPHONE == 1 || TARGET_OS_IPHONE_SIMULATOR == 1
  [[NSRunLoop currentRunLoop] performSelector:@selector(run) target:cmd argument:nil order:0 modes:@[NSDefaultRunLoopMode]];
  #else
  [cmd run];
  #endif
}

- (void)scheduleFixedDelayWithJavaLangRunnable:(id<JavaLangRunnable>)cmd
                                       withInt:(int)delayMs {
  [NSTimer scheduledTimerWithTimeInterval:delayMs/1000
  target:cmd
  selector:@selector(run)
  userInfo:nil
  repeats:NO];
}

- (id)init {
  return [super init];
}

@end
