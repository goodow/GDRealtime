//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: src/main/java/com/goodow/realtime/channel/rpc/DeltaService.java
//
//  Created by retechretech on 13-5-25.
//

#import "IOSClass.h"
#import "com/goodow/realtime/Realtime.h"
#import "com/goodow/realtime/channel/rpc/Constants.h"
#import "com/goodow/realtime/channel/rpc/DeltaService.h"
#import "com/goodow/realtime/channel/rpc/Rpc.h"
#import "com/goodow/realtime/channel/rpc/RpcUtil.h"
#import "elemental/json/JsonArray.h"
#import "elemental/json/JsonObject.h"
#import "elemental/util/Collections.h"
#import "elemental/util/MapFromStringToString.h"
#import "java/lang/Throwable.h"
#import "java/util/logging/Logger.h"

@implementation ComGoodowRealtimeChannelRpcDeltaService

static JavaUtilLoggingLogger * ComGoodowRealtimeChannelRpcDeltaService_log_;

@synthesize rpc = rpc_;

+ (JavaUtilLoggingLogger *)log {
  return ComGoodowRealtimeChannelRpcDeltaService_log_;
}

- (id)initWithComGoodowRealtimeChannelRpcRpc:(id<ComGoodowRealtimeChannelRpcRpc>)rpc {
  if ((self = [super init])) {
    self.rpc = rpc;
  }
  return self;
}

- (void)fetchHistoryWithNSString:(NSString *)key
                         withInt:(int)startRev
withComGoodowRealtimeChannelRpcDeltaService_Callback:(id<ComGoodowRealtimeChannelRpcDeltaService_Callback>)callback {
  id<ElementalUtilMapFromStringToString> params = [ElementalUtilCollections mapFromStringToString];
  [((id<ElementalUtilMapFromStringToString>) NIL_CHK(params)) putWithNSString:[ComGoodowRealtimeChannelRpcConstants_Params ID] withNSString:key];
  [((id<ElementalUtilMapFromStringToString>) NIL_CHK(params)) putWithNSString:[ComGoodowRealtimeChannelRpcConstants_Params ACCESS_TOKEN] withNSString:[GDRRealtime getToken]];
  [((id<ElementalUtilMapFromStringToString>) NIL_CHK(params)) putWithNSString:[ComGoodowRealtimeChannelRpcConstants_Params START_REVISION] withNSString:[NSString stringWithFormat:@"%d", startRev]];
  [((id<ComGoodowRealtimeChannelRpcRpc>) NIL_CHK(rpc_)) getWithNSString:[ComGoodowRealtimeChannelRpcConstants_Services DELTA] withElementalUtilMapFromStringToString:params withComGoodowRealtimeChannelRpcRpc_RpcCallback:[[ComGoodowRealtimeChannelRpcDeltaService_$1 alloc] initWithComGoodowRealtimeChannelRpcDeltaService_Callback:callback]];
}

+ (void)initialize {
  if (self == [ComGoodowRealtimeChannelRpcDeltaService class]) {
    ComGoodowRealtimeChannelRpcDeltaService_log_ = [JavaUtilLoggingLogger getLoggerWithNSString:[[IOSClass classWithClass:[ComGoodowRealtimeChannelRpcDeltaService class]] getName]];
  }
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  ComGoodowRealtimeChannelRpcDeltaService *typedCopy = (ComGoodowRealtimeChannelRpcDeltaService *) copy;
  typedCopy.rpc = rpc_;
}

@end
@implementation ComGoodowRealtimeChannelRpcDeltaService_$1

@synthesize val$callback = val$callback_;

- (void)onConnectionErrorWithJavaLangThrowable:(JavaLangThrowable *)e {
  [((id<ComGoodowRealtimeChannelRpcDeltaService_Callback>) NIL_CHK(val$callback_)) onConnectionErrorWithJavaLangThrowable:e];
}

- (void)onFatalErrorWithJavaLangThrowable:(JavaLangThrowable *)e {
  [((id<ComGoodowRealtimeChannelRpcDeltaService_Callback>) NIL_CHK(val$callback_)) onFatalErrorWithJavaLangThrowable:e];
}

- (void)onSuccessWithNSString:(NSString *)data {
  id<EMJsonObject> msg = ((id<EMJsonObject>) [ComGoodowRealtimeChannelRpcRpcUtil evalPrefixedWithNSString:data]);
  NSAssert([((id<EMJsonArray>) [((id<EMJsonObject>) NIL_CHK(msg)) getArrayWithNSString:[ComGoodowRealtimeChannelRpcConstants_Params DELTAS]]) length] > 0, @"src/main/java/com/goodow/realtime/channel/rpc/DeltaService.java:63 condition failed: assert msg.getArray(Params.DELTAS).length() > 0;");
  [((id<ComGoodowRealtimeChannelRpcDeltaService_Callback>) NIL_CHK(val$callback_)) onMessageWithEMJsonObject:msg];
}

- (id)initWithComGoodowRealtimeChannelRpcDeltaService_Callback:(id<ComGoodowRealtimeChannelRpcDeltaService_Callback>)capture$0 {
  if ((self = [super init])) {
    val$callback_ = capture$0;
  }
  return self;
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  ComGoodowRealtimeChannelRpcDeltaService_$1 *typedCopy = (ComGoodowRealtimeChannelRpcDeltaService_$1 *) copy;
  typedCopy.val$callback = val$callback_;
}

@end
